第一次做到拟态题，题目提供了两个elf文件，一个32位一个64位均为静态链接的程序，有大量gadget片段，且都存在栈溢出漏洞。

> 类似于生物界的拟态防御，在网络空间防御领域，在目标对象给定服务功能和性能不变前提下，其内部架构、冗余资源、运行机制、核心算法、异常表现等环境因素，
> 以及可能附着其上的未知漏洞后门或木马病毒等都可以做策略性的时空变化，从而对攻击者呈现出“似是而非”的场景，以此扰乱攻击链的构造和生效过程，使攻击成功的代价倍增。

> CMD 在技术上以融合多种主动防御要素为宗旨：以异构性、多样或多元性改变目标系统的相似性、单一性；以动态性、随机性改变目标系统的静态性、确定性；
> 以异构冗余多模裁决机制识别和屏蔽未知缺陷与未明威胁；以高可靠性架构增强目标系统服务功能的柔韧性或弹性；以系统的视在不确定属性防御或拒止针对目标系统的不确定性威胁。

> 对CTF的pwn来说，题目的功能不变，但运行的环境架构不同（64位和32位），设立检测输出裁决机，保证输入和输出的信息相同，并且两端程序都要保持正常服务。
> 这对需要泄露动态加载库地址、堆地址、程序基址的方法是扼住咽喉的一个防御方式，使得目标系统的安全性大幅度提升。
> 而要突破这种防御机制，也不是没有办法，可以采用逐字节爆破、partial write等技巧不泄露信息来getshell。

以我个人的理解，就是输入的payload要同时控制两个程序的执行流程，保证两个程序的执行状态以及IO保持一致。

程序分析：
两个程序首先输出一致的提示信息，然后用户输入0x300字节数据，两个程序中都会出现栈溢出，32位下距离eip为0x110，64位下距离rip为0x118。

攻击思路：
由于两者返回地址不同，所以分别在返回地址处填上```add_esp_0xc_ret```和```add_rsp_0x38_ret```这两条指令来调整堆栈，然后在相应位置放上32位的ROP链和64位的ROP链。

[参考博客](https://www.anquanke.com/post/id/195801)

[参考博客](https://xz.aliyun.com/t/5532#toc-1)

[参考博客](https://blog.csdn.net/seaaseesa/article/details/105407007)
