64位下堆题，增删查改四项功能，glibc版本为2.27，有tchache机制，比较奇怪的是用patchelf发现改不了ld，最后没办法只能在ubuntu1804下面实验。

程序分析：没有除掉符号表所以功能都比较清晰，添加只能选择0x18和0x38两种大小，最后得到的堆块也就是0x20或者0x40两种，管理堆块也是0x20，数据部分前8字节放size，后8字节放ptr。
增删查都是常规功能，没有问题。漏洞点在于修改处，能够溢出一字节。

攻击思路：申请0x18大小都数据堆，利用前一堆块的溢出漏洞把管理堆块0x21大小改成0x41，释放时就会把管理堆放入0x40的tcache，把数据堆放入0x20的tcache，造成堆叠。
下次申请0x38大小的数据堆，由于堆叠可以控制相邻的管理堆，然后把管理堆中的指针改成got表，以泄露libc基址和实现攻击。
